# 小程序用户授权

1. 用户授权一共分为三种版本
   1. 第一种(最早)
      1. 通过wx.getUserInfo实现弹窗效果
      2. 早期由于该API滥用,导致用户体验极差,所以后续微信官方对该API进行严格要求
         1. 该接口必须在用户**已经授权之后**才可以使用
   2. 第二种(中等,通过button组件实现)
      1. 给button组件添加open-type="getUserInfo"属性,可以实现点击出现授权弹窗的效果
      2. 通过绑定事件getuserinfo,其中可以从形参的detail属性中获取到用户信息
      3. 将获取到的用户信息更新到data中,之后在页面中使用即可
   3. 第三种(最新)
      1. 通过wx.getUserProfile实现
      2. 流程:
         1. 在wxml中,给一个组件绑定tap事件
         2. 在tap事件的回调函数中,调用该API,实现授权弹窗功能
      3. 注意:
         1. 报错wx.getUserProfile is not a function
            1. 原因:由于微信小程序基础库版本过低,所以无法使用
            2. 解决:更换基础库版本,**该API仅在基础库2.15.0以上可以使用**
         2. **该函数必须在tap事件的回调函数中执行才能生效**
         3. **调用一次该API,就会出现一次弹窗**
         4. 如果想通过该API实现二次登陆免授权,必须自己缓存用户数据(本地存储Storage),后续自动展示
         5. 可以通过**wx.canIUse('getUserProfile')**判断当前用户微信基础库版本,是否能够使用该API,如果无法使用,就执行第二种方案
         6. 配置对象中必须传递**desc**属性,不传无法出现弹窗
2. 用户二次登录免授权
   1. 通过wx.getUserInfo获取用户基本信息
      1. 注意:该接口必须在用户**已经授权之后**才可以使用
3. 扩展
   1. open-data组件
      1. 该组件可以在不经过用户授权的情况下,展示用户的部分基础信息
      2. 但是该API很鸡肋,因为只能展示,无法获取到内部数据,所以对于开发无用

